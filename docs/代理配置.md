# 配置代理服务器

## 配置代理软件
请确保代理软件在本机能够正常访问，`V2ray`在界面中下方的系统代理选项选到`自动配置系统代理`，`Clash`则在设置中打开`系统代理`开关。

### 允许来自局域网的连接
- V2ray

![](https://img.xinit.xyz/docsify20250712134706694.png)

- Clash Verge（或 Clash for windows）

![](https://img.xinit.xyz/docsify20250712135017627.png)


## 设置http/https代理

软件里开启代理后默认绝大部分带UI的软件都能正常走代理，但是终端程序默认不会走代理。

> 注：设置了代理后`ping`命令也不会走代理，`ping`命令是`ICMP`协议不是`http/https`协议
> 可以使用`wget google.com`测试代理
> ```sh
> PS C:\> wget www.google.com
> --2025-07-12 22:16:48--  http://www.google.com/
> Connecting to 127.0.0.1:10809... connected.
> Proxy request sent, awaiting response... 200 OK
> Length: unspecified [text/html]
> Saving to: `index.html'
>
>     [  <=>              ] 17,526      67.3K/s   in 0.3s
>
> 2025-07-12 22:16:49 (67.3 KB/s) - `index.html' saved [17526]
> ```

### 在本机终端中设置

终端里的命令行程序基本上不会自动使用代理，因此需要手动设置。




> **设置的代理仅在当前终端中有效，重新打开终端后失效，需要重新设置**

假设我的**本机**代理服务器地址为`127.0.0.1:10809` （`v2ray`一般是`10809`，`clash`一般是`7890`），**请一定要根据自己的代理地址和端口设置代理**

#### Windows下
设置环境变量：
- cmd
```sh
set http_proxy="http://127.0.0.1:10809"
set https_proxy="http://127.0.0.1:10809"
# 或者可以像这样一行设置好
set PROXY="http://127.0.0.1:10809" && set http_proxy=%PROXY% && set https_proxy=%PROXY%
```
- powershell
```sh
$env:http_proxy="http://127.0.0.1:10809"
$env:https_proxy="http://127.0.0.1:10809"
# 或者可以像这样一行设置好
$env:PROXY="http://127.0.0.1:10809"; $env:http_proxy=$env:PROXY; $env:https_proxy=$env:PROXY
```

#### Linux下
设置环境变量：
```sh
export http_proxy="http://127.0.0.1:10809"
export https_proxy="http://127.0.0.1:10809"
# 或者可以像这样一行设置好
PROXY="http://127.0.0.1:10809" export http_proxy="${PROXY}" https_proxy="${PROXY}"
```

使用`sudo`执行命令时，需要给`sudo `加上`-E`参数才能使用代理，使用`sudo su`或`su`切换到其他用户同样需要重新配置

### 设置局域网中的其他设备使用本机的代理

参照上一节设置，注意代理地址应为开启了代理软件的系统的ip地址

假如有一台设备A中安装并配置好了代理软件，需要局域网中其他设备B中使用A的代理，
设备A和设备B都在同一局域网中（同一个WIFI或使用网线直连或用网线连接到一个交换机），
其中设备A的地址为`192.168.1.12`，设备B的地址为`192.168.1.55`，
设备A的代理软件已开启局域网访问，端口为`10809`（http/https）

则在设备B的终端上设置代理：
```sh
export http_proxy="http://192.168.1.12:10809"
export https_proxy="http://192.168.1.12:10809"
```
如果设备B是Windows，可以在`设置->网络和Internet设置->代理->手动设置代理`中配置代理服务器
